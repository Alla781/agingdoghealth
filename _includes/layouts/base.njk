<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ (title or site.name) | safe }}</title>
  <meta name="description" content="{{ description or site.description }}">
  <link rel="canonical" href="{{ (site.url or '') }}{{ page.url | url }}" />

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <!-- Open Graph -->
  <meta property="og:title" content="{{ title or 'Aging Dog Health' }}">
  <meta property="og:description" content="Guides and remedies for senior dogs — trusted, caring advice.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ (site.url or 'https://agingdoghealth.com') }}{{ page.url | url }}">
  <meta property="og:image" content="{{ (site.url or 'https://agingdoghealth.com') }}/assets/og-image.jpg">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ title or 'Aging Dog Health' }}">
  <meta name="twitter:description" content="Practical health tips for senior dogs.">
  <meta name="twitter:image" content="{{ (site.url or 'https://agingdoghealth.com') }}/assets/og-image.jpg">

  <!-- GA4 + Search Console placeholders -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-XXXXXXXXXX');</script>
  <meta name="google-site-verification" content="ADD_YOUR_VERIFICATION_TOKEN_HERE" />

  <!-- JSON-LD -->
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"WebSite","name":"Aging Dog Health","url":"https://agingdoghealth.com",
   "potentialAction":{"@type":"SearchAction","target":"https://agingdoghealth.com/?s={search_term_string}","query-input":"required name=search_term_string"}}
  </script>
  {% if page.url and title %}
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BlogPosting","headline":"{{ title | escape }}",
   "author":{"@type":"Organization","name":"Aging Dog Health"},
   "publisher":{"@type":"Organization","name":"Aging Dog Health"},
   "url":"https://agingdoghealth.com{{ page.url }}","mainEntityOfPage":"https://agingdoghealth.com{{ page.url }}"}
  </script>
  {% endif %}

  <style>
    :root{
      --accent:#1e4a36;     /* tune to your palette */
      --stroke:#e6e6e6;
      --muted:#596269;
      --drawer-w:320px;
    }
    html{box-sizing:border-box},:before,*:after{box-sizing:inherit}
    body{margin:0;font-family:'Lato',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;line-height:1.55;color:#111;background:#fff}
    a{text-decoration:none;color:inherit}
    .container{max-width:1100px;margin:0 auto;padding:0 16px}

    /* Header */
    .site-header{position:sticky;top:0;z-index:1200;background:#fff;border-bottom:1px solid var(--stroke)}
    .site-row{display:flex;align-items:center;justify-content:space-between;height:62px}
    .brand{display:inline-flex;align-items:center;gap:10px;font-weight:700}
    .brand img{height:28px;width:auto}

    /* Hamburger */
    .menu-toggle{display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border:0;background:transparent;cursor:pointer}
    .menu-toggle .bars{position:relative;width:22px;height:2px;background:#111}
    .menu-toggle .bars:before,.menu-toggle .bars:after{content:"";position:absolute;left:0;right:0;height:2px;background:#111}
    .menu-toggle .bars:before{top:-7px}.menu-toggle .bars:after{top:7px}

    /* Drawer (mobile) */
    nav[data-drawer]{position:fixed;top:0;left:0;bottom:0;width:var(--drawer-w);background:#fff;transform:translateX(-100%);transition:transform .25s ease-out;box-shadow:0 0 0 1px rgba(0,0,0,.04),0 10px 30px rgba(0,0,0,.15);padding:16px;overflow-y:auto;z-index:1100;border-right:6px solid var(--accent)}
    nav[data-drawer] .drawer-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    nav[data-drawer] ul{list-style:none;padding:0;margin:0}

    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;transition:opacity .2s ease;z-index:1050}
    .overlay[hidden]{display:none}
    body.nav-open nav[data-drawer]{transform:translateX(0)}
    body.nav-open{overflow:hidden}
    body.nav-open .overlay{opacity:1}

    /* Desktop nav */
    @media(min-width:992px){
      nav[data-drawer]{position:static;transform:none;box-shadow:none;width:auto;height:auto;padding:0;overflow:visible;border-right:0}
      nav[data-drawer] .drawer-head{display:none}
      nav[data-drawer] > ul{display:flex;gap:28px;align-items:stretch}
      nav[data-drawer] > ul > li{position:relative}
      nav[data-drawer] > ul > li > a{display:inline-block;font-weight:700;padding:18px 0;position:relative}
      nav[data-drawer] > ul > li > a::after{
        content:"";position:absolute;left:0;right:0;bottom:-1px;height:3px;background:var(--accent);
        transform:scaleX(0);transform-origin:left;transition:transform .18s ease;
      }
      nav[data-drawer] > ul > li:hover > a::after,
      nav[data-drawer] > ul > li:focus-within > a::after{transform:scaleX(1)}

      .dropdown{
  position:absolute;top:100%;left:0;display:none;background:#fff;border:1px solid var(--stroke);
  border-radius:10px;box-shadow:0 12px 28px rgba(0,0,0,.14);margin-top:0;padding:12px 12px;
}
.has-children{position:relative}
.has-children::after{
  content:"";
  position:absolute; left:0; right:0; top:100%; height:6px;  /* extends hover area */
}
      .dropdown ul{columns:2;column-gap:24px;margin:0;padding:0}
      .dropdown li{break-inside:avoid}
      .dropdown a{display:block;padding:8px 10px;font-weight:600;color:#111;border-radius:6px}
      .dropdown a:hover{background:#f7f7f7}
      .has-children:hover>.dropdown,.has-children:focus-within>.dropdown{display:block}

      .menu-toggle{display:none}
      .overlay{display:none!important}
    }
.dropdown{display:none}
    /* Mobile drilldown */
    .panel-root{margin:0;padding:0}
    .panel-root > li > a{display:block;padding:12px 4px;font-weight:700}
   .child-panel[hidden]{display:none}
.panel-root[hidden]{display:none}
    .back-link{margin:6px 0 10px;padding:8px 0;background:transparent;border:0;color:var(--accent);font-weight:700;font-size:16px;text-align:left;cursor:pointer}
    .child-title{margin:0 0 8px;font-size:18px;font-weight:700}
    .child-list a{display:block;padding:10px 6px;border-radius:6px;color:#103a2b}
    .child-list a:hover{background:#f5f7f6}

    /* Main/Footer */
    main{padding:24px 0}
    footer{margin-top:40px;border-top:1px solid var(--stroke);padding:24px 0;color:#555}
  </style>
</head>

<body class="{{ page.class | default('') }}">
  <a class="skip-link" href="#content">Skip to content</a>

  {% set nav_items = nav or site.nav or _data.nav or [] %}
  {% if not nav_items.length %}
    {% set nav_items = [
      { "title": "Articles", "url": "/articles/" },
      { "title": "About", "url": "/about/" },
      { "title": "Contact", "url": "/contact/" },
      { "title": "Privacy Policy", "url": "/privacy-policy/" },
      { "title": "Terms", "url": "/terms/" }
    ] %}
  {% endif %}

  <header class="site-header" role="banner">
    <div class="container site-row">
      <a class="brand" href="{{ '/' | url }}">
        <img src="/assets/logo.svg" alt="Aging Dog Health" />
        <span>{{ site.name or 'Aging Dog Health' }}</span>
      </a>

      <nav id="siteNav" data-drawer aria-label="Primary">
        <div class="drawer-head">
          <strong>Menu</strong>
       <button id="closeDrawer" class="menu-toggle" aria-label="Close menu"><span aria-hidden="true" style="font-size:22px;line-height:1">×</span></button>
        </div>

        <!-- ROOT list (desktop uses this; mobile uses as level 1) -->
        <ul class="panel-root">
          {% for item in nav_items %}
            {% if item.children %}
              <li class="has-children">
                <a href="{{ item.url | url }}" data-title="{{ item.title }}">{{ item.title }}</a>
                <div class="dropdown" aria-hidden="true">
                  <ul>
                    {% for child in item.children %}
                      <li><a href="{{ child.url | url }}">{{ child.title }}</a></li>
                    {% endfor %}
                  </ul>
                </div>
              </li>
            {% else %}
              <li><a href="{{ item.url | url }}">{{ item.title }}</a></li>
            {% endif %}
          {% endfor %}
        </ul>

        <!-- CHILD panel (mobile level 2) -->
        <div id="childPanel" class="child-panel" hidden>
          <button type="button" class="back-link" id="backLink">‹ Back</button>
          <h3 class="child-title" id="childTitle"></h3>
          <ul class="child-list"></ul>
        </div>
      </nav>

      <button id="menuToggle" class="menu-toggle" aria-controls="siteNav" aria-expanded="false" aria-label="Open menu">
        <span class="bars" aria-hidden="true"></span>
      </button>
    </div>
  </header>

  <div id="overlay" class="overlay" hidden></div>

  <main id="content" class="container" tabindex="-1">
    {{ content | safe }}
  </main>

  <footer role="contentinfo">
    <div class="container" style="display:flex;gap:16px;justify-content:space-between;align-items:center;flex-wrap:wrap;padding:18px 0;">
      <div>&copy; {{ site.name or 'Aging Dog Health' }} {{ site.year }}</div>
      <div><a href="/privacy-policy/">Privacy Policy</a> · <a href="/terms/">Terms</a> · <a href="/contact/">Contact</a></div>
    </div>
  </footer>

  <script>
    (function(){
      var body = document.body;
      var nav  = document.getElementById('siteNav');
      var toggle = document.getElementById('menuToggle');
      var closeBtn = document.getElementById('closeDrawer');
      var overlay = document.getElementById('overlay');

      var rootList   = nav.querySelector('.panel-root');
      var childPanel = document.getElementById('childPanel');
      var backLink   = document.getElementById('backLink');
      var childTitle = document.getElementById('childTitle');
      var childList  = childPanel.querySelector('.child-list');

      function isDesktop(){ return window.matchMedia('(min-width: 992px)').matches; }
      function openNav(){ body.classList.add('nav-open'); overlay.hidden=false; toggle.setAttribute('aria-expanded','true'); }
      function closeNav(){ body.classList.remove('nav-open'); overlay.hidden=true; toggle.setAttribute('aria-expanded','false'); showRoot(); }
      function showRoot(){ rootList.hidden=false; childPanel.hidden=true; }
      function showChildren(title, anchors){
        childTitle.textContent = title;
        childList.innerHTML = '';
        anchors.forEach(function(a){
          var li = document.createElement('li');
          var link = document.createElement('a');
          link.href = a.href; link.textContent = a.textContent;
          childList.appendChild(li).appendChild(link);
        });
        rootList.hidden = true; childPanel.hidden = false;
      }

      toggle.addEventListener('click', function(){ body.classList.contains('nav-open') ? closeNav() : openNav(); });
      if (closeBtn) closeBtn.addEventListener('click', closeNav);
      overlay.addEventListener('click', closeNav);
      backLink.addEventListener('click', showRoot);

      // Mobile drilldown: tap top item with children → second view
      nav.addEventListener('click', function(e){
        var a = e.target.closest('a');
        if(!a) return;
        var li = a.closest('li.has-children');
        if (!li) return; // simple links go through
        if (!isDesktop() && body.classList.contains('nav-open')) {
          var dropdown = li.querySelector('.dropdown'); if (!dropdown) return;
          e.preventDefault();
          var anchors = Array.from(dropdown.querySelectorAll('a'));
          showChildren(a.getAttribute('data-title') || a.textContent.trim(), anchors);
        }
      });

      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape' && body.classList.contains('nav-open')) closeNav();
      });

      window.addEventListener('resize', function(){ if (isDesktop()) { showRoot(); } });
    })();
  </script>
<script>
(function () {
  var nav = document.getElementById('siteNav');
  if (!nav) return;

  var rootList   = nav.querySelector('.panel-root');   // headings list
  var childPanel = nav.querySelector('#childPanel');   // drill-in panel
  var backLink   = nav.querySelector('#backLink');
  var childTitle = nav.querySelector('#childTitle');
  var childList  = nav.querySelector('.child-list');

  function isDesktop() {
    return window.matchMedia('(min-width: 992px)').matches;
  }

  // Tap a heading on mobile → show its sub-links
  nav.querySelectorAll('.has-children > a').forEach(function (a) {
    a.addEventListener('click', function (e) {
      if (isDesktop()) return;         // desktop uses hover dropdowns
      e.preventDefault();

      var li = this.parentElement;
      var dd = li.querySelector('.dropdown ul');   // desktop submenu list
      if (!dd) return;

      // Title from data-title if present, else link text
      childTitle.textContent = this.dataset.title || this.textContent.trim();
      childList.innerHTML = dd.innerHTML;

      // Show child panel, hide headings (toggle ⁠ hidden ⁠)
      rootList.hidden = true;
      childPanel.hidden = false;
      backLink.focus();
    });
  });

  // ‹ Back → return to headings list
  if (backLink) {
    backLink.addEventListener('click', function (e) {
      e.preventDefault();
      childPanel.hidden = true;
      childList.innerHTML = '';
      rootList.hidden = false;
    });
  }
})();
</script>
</body>
</html>
